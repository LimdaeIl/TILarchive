# ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸ / ì„¹ì…˜ 9 ê°’ íƒ€ì…



## 1. JPAì˜ ë°ì´í„° íƒ€ì… ë¶„ë¥˜ 

- **ì—”í‹°í‹° íƒ€ì…**
  - ì—”í‹°í‹° íƒ€ì…ì€ @Entityë¡œ ì •ì˜í•˜ëŠ” ê°ì²´ë¡œ @Entityë¥¼ ë¶™ì—¬ì„œ ê´€ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
  - PKê°’ìœ¼ë¡œ ê´€ë¦¬ê°€ ë˜ê¸°ë•Œë¬¸ì— ë°ì´í„°ê°€ ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì†ì ìœ¼ë¡œ ì¶”ì ì´ ê°€ëŠ¥í•˜ê³  ê´€ë¦¬ë„ í¸ë¦¬í•©ë‹ˆë‹¤.
  - ì˜ˆ) íšŒì› ì—”í‹°í‹°ì˜ í‚¤ë‚˜ ë‚˜ì´ ê°’ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥í•©ë‹ˆë‹¤.

- **ê°’ íƒ€ì…**
  - int, Integer, Stringì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´ì…ë‹ˆë‹¤.
  - ì‹ë³„ìê°€ ì—†ê³  ê°’ë§Œ ìˆìœ¼ë¯€ë¡œ ë³€ê²½ì‹œ ì¶”ì ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
  - ì˜ˆ) ìˆ«ì 100ì„ 200ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤.



## 2. ê°’ íƒ€ì… ë¶„ë¥˜

### 2.1ê¸°ë³¸ê°’ íƒ€ì…

- JPA(Java Persistence API)ì—ì„œ ê¸°ë³¸ê°’ íƒ€ì…ì€ ì—”í„°í‹°ê°€ ì•„ë‹Œ **ì¼ë°˜ì ì¸ ìë°” ë°ì´í„° íƒ€ì…**ì„ ë§í•©ë‹ˆë‹¤. 
- ê¸°ë³¸ê°’ íƒ€ì…ì€ ì—”í„°í‹°ì˜ ì†ì„±ìœ¼ë¡œ ì‚¬ìš©ë˜ì§€ë§Œ, ì—”í„°í‹°ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ìƒëª…ì£¼ê¸°ë‚˜ ì‹ë³„ìë¥¼ ê°€ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. 
- ê°„ë‹¨íˆ ë§í•´, ê¸°ë³¸ê°’ íƒ€ì…ì€ **ë‹¨ìˆœíˆ ê°’ ìì²´ë¥¼ ë‚˜íƒ€ë‚´ë©° ì—”í„°í‹°ì˜ ì¼ë¶€ë¡œë§Œ ì‚¬ìš©**ë©ë‹ˆë‹¤.



### 2.2 ê¸°ë³¸ê°’ íƒ€ì…ì˜ íŠ¹ì§•

1. **ìƒëª…ì£¼ê¸° ê´€ë¦¬**
   - ê¸°ë³¸ê°’ íƒ€ì…ì€ ì—”í„°í‹°ì™€ëŠ” ë‹¬ë¦¬ ìì²´ì ì¸ ìƒëª…ì£¼ê¸°ë¥¼ ê°–ì§€ ì•ŠìŠµë‹ˆë‹¤. 
   - ë”°ë¼ì„œ ì—”í„°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
   - ê¸°ë³¸ê°’ íƒ€ì…ì€ ìƒëª…ì£¼ê¸°ë¥¼ ì—”í„°í‹°ì— ì˜ì¡´í•©ë‹ˆë‹¤.
   - ì˜ˆ) íšŒì›ì„ ì‚­ì œí•˜ë©´ ì´ë¦„, ë‚˜ì´ í•„ë“œë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.

2. **ì‹ë³„ìê°€ ì—†ìŒ**
   - ê¸°ë³¸ê°’ íƒ€ì…ì€ ë³„ë„ì˜ ì‹ë³„ìë¥¼ ê°–ì§€ ì•ŠìŠµë‹ˆë‹¤.
   - ë”°ë¼ì„œ ì—”í„°í‹°ì™€ ë‹¬ë¦¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìì²´ì ìœ¼ë¡œ ì‹ë³„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

3. **ê°’ íƒ€ì… ì»¬ëŸ¼ ë§¤í•‘**
   - ê¸°ë³¸ê°’ íƒ€ì…ì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¨ì¼ ì»¬ëŸ¼ì— ë§¤í•‘ë˜ë©°, ê°’ì´ í•„ë“œì— ì €ì¥ë©ë‹ˆë‹¤. 
   - ì»¬ëŸ¼ì€ ì—”í„°í‹°ì˜ í…Œì´ë¸”ì— ì†í•˜ê²Œ ë©ë‹ˆë‹¤.
   - ê°’ íƒ€ì…ì€ ê³µìœ í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.
   - ì˜ˆ) íšŒì› ì´ë¦„ ë³€ê²½ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ ì´ë¦„ë„ í•¨ê»˜ ë³€ê²½ë˜ë©´ ì•ˆë©ë‹ˆë‹¤.

4. **ë¶ˆë³€ì„± ìœ ì§€**
   - ê¸°ë³¸ê°’ íƒ€ì…ì˜ ê°ì²´ëŠ” ë¶ˆë³€(immutable)í•´ì•¼ í•©ë‹ˆë‹¤. ì¦‰, í•œ ë²ˆ ìƒì„±ëœ ê°’ì€ ë³€ê²½ë˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤. 
   - ì´ëŠ” ê°’ íƒ€ì…ì´ ì—”í„°í‹°ì˜ ë³€ê²½ ì¶”ì ì´ë‚˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ê¸°ë³¸ê°’ íƒ€ì…ì˜ ì˜ˆì‹œë¡œëŠ” **ìë°”ì˜ ê¸°ë³¸ ë°ì´í„° íƒ€ì…(int, double, boolean ë“±)**ì´ë‚˜ **ë¶ˆë³€ í´ë˜ìŠ¤ë“¤(String, LocalDate ë“±)**ì´ ìˆìŠµë‹ˆë‹¤. JPAì—ì„œëŠ” **`@Embeddable` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì—”í„°í‹°ì— í¬í•¨ë˜ëŠ” ê°’ íƒ€ì…ì„ ì •ì˜**í•˜ê³ , **`@Embedded` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì—”í„°í‹°ì˜ ì†ì„±ìœ¼ë¡œ ê°’ íƒ€ì…ì„ ë§¤í•‘**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **ìë°” ê¸°ë³¸ íƒ€ì…(int, double)**: í•­ìƒ ê°’ì„ ë³µì‚¬í•˜ê¸° ë•Œë¬¸ì— ì ˆëŒ€ ê³µìœ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- **ë˜í¼ í´ë˜ìŠ¤(Integer, Long)**: ê³µìœ  ê°€ëŠ¥í•œ(ì°¸ì¡°ê°’ì„ ê³µìœ í•˜ë¯€ë¡œ) ê°ì²´ì´ì§€ë§Œ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ìŠµë‹ˆë‹¤.
- **String**



### 2.3 ê¸°ë³¸ê°’ íƒ€ì… ì˜ˆì œ 1

```java
int a = 10;
int b = a;

a = 20; // aì˜ ê°’ë§Œ ë³€ê²½ë  ë¿, bì˜ ê°’ì€ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤.
```

```java
Integer a = new Integer(10);
Integer b = a;

// a.setValue(20); ì´ëŸ° ë©”ì„œë“œê°€ ìˆìœ¼ë©´ ê°€ëŠ¥í•  ê²ƒì´ë‹¤
```

 

### 2.4 ê¸°ë³¸ê°’ íƒ€ì… ì˜ˆì œ 2

- ê¸°ë³¸ê°’ íƒ€ì…ì˜ ì˜ˆì‹œë¡œ `@Embeddable` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ **ë§¤í•‘ëœ ë³µí•© ê°’ íƒ€ì…(composite value type)**ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. 
- ë³µí•© ê°’ íƒ€ì…ì€ **ì—¬ëŸ¬ ê°œì˜ ê¸°ë³¸ê°’ íƒ€ì…ì„ ë¬¶ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.**

ì˜ˆë¥¼ ë“¤ì–´, ì£¼ì†Œ ì •ë³´ë¥¼ ê°–ëŠ” `Address` í´ë˜ìŠ¤ê°€ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ í´ë˜ìŠ¤ëŠ” ë‹¨ìˆœíˆ ì£¼ì†Œ ì •ë³´ë§Œì„ í¬í•¨í•˜ê³  ìˆì–´ì„œ ì—”í„°í‹°ê°€ ì•„ë‹Œ ê°’ íƒ€ì…ìœ¼ë¡œ ì í•©í•©ë‹ˆë‹¤.

```java
@Embeddable
public class Address {
    private String street;
    private String city;
    private String zipCode;

    // ìƒì„±ì, getter, setter ë“± í•„ìš”í•œ ë©”ì„œë“œë“¤ì„ êµ¬í˜„
}
```

ê·¸ë¦¬ê³  ì´ ì£¼ì†Œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” ì—”í„°í‹°ì¸ `Person` í´ë˜ìŠ¤ì—ì„œëŠ” `Address`ë¥¼ ê°’ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
@Entity
public class Person {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    @Embedded
    private Address address;

    // ìƒì„±ì, getter, setter ë“± í•„ìš”í•œ ë©”ì„œë“œë“¤ì„ êµ¬í˜„
}
```

ìœ„ì˜ ì½”ë“œì—ì„œ `@Embedded` ì–´ë…¸í…Œì´ì…˜ì€ **`Person` ì—”í„°í‹°ì˜ `address` í•„ë“œê°€ ê°’ íƒ€ì…ì¸ `Address` í´ë˜ìŠ¤ë¥¼ í¬í•¨í•œë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.** ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ `Person` ì—”í„°í‹°ëŠ” ì£¼ì†Œ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê²Œ ë˜ê³ , í•´ë‹¹ ì£¼ì†Œ ì •ë³´ëŠ” `Person` í…Œì´ë¸”ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤.

ì´ì œ `Person` ì—”í„°í‹°ë¥¼ ì €ì¥í•˜ë©´, í•´ë‹¹ ì—”í„°í‹°ì˜ ì£¼ì†Œ ì •ë³´ë„ í•¨ê»˜ ì €ì¥ë˜ë©°, ì¡°íšŒí•  ë•ŒëŠ” ì—”í„°í‹°ë¥¼ ë¡œë“œí•  ë•Œ ì£¼ì†Œ ì •ë³´ë„ í•¨ê»˜ ë¡œë“œë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ê¸°ë³¸ê°’ íƒ€ì…ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì½”ë“œë¥¼ ë³´ë‹¤ ê°„ê²°í•˜ê³  ì˜ë¯¸ë¡ ì ìœ¼ë¡œ í’ë¶€í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.





## 3. ì„ë² ë””ë“œ íƒ€ì…

- ì„ë² ë””ë“œ íƒ€ì…ì€ JPAì—ì„œ ì—”í„°í‹°ì— ì†í•œ, ê·¸ëŸ¬ë‚˜ **ë³„ë„ì˜ í…Œì´ë¸”ì„ ê°€ì§€ì§€ ì•Šê³  ì—”í„°í‹°ì˜ í…Œì´ë¸”ì— í•©ì³ì ¸ ì €ì¥ë˜ëŠ” íƒ€ì…**ì…ë‹ˆë‹¤.
- ì¦‰, ì„ë² ë””ë“œ íƒ€ì…ì€ **ì—¬ëŸ¬ ê¸°ë³¸ê°’ íƒ€ì…ì´ë‚˜ ë‹¤ë¥¸ ì„ë² ë””ë“œ íƒ€ì…ì„ ë‹´ê³  ìˆëŠ” ë³µí•© íƒ€ì…**ì…ë‹ˆë‹¤. 
- ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì½”ë“œì˜ ì¬ì‚¬ìš©ì„±ì„ ë†’ì´ê³  ë³µì¡í•œ êµ¬ì¡°ë¥¼ ê°„ì†Œí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



### 3.1 ì„ë² ë””ë“œ íƒ€ì…ì˜ íŠ¹ì§•

1. **ë³µí•© íƒ€ì… ì§€ì›**
   - ì„ë² ë””ë“œ íƒ€ì…ì€ ì—¬ëŸ¬ ê¸°ë³¸ ë°ì´í„° íƒ€ì…ì´ë‚˜ ë‹¤ë¥¸ ì„ë² ë””ë“œ íƒ€ì…ì„ ë¬¶ì–´ì„œ ë³µí•© íƒ€ì…ì„ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   - ì¦‰, ì—¬ëŸ¬ ì†ì„±ì„ ë‹¨ì¼ ê°ì²´ë¡œ ë¬¶ì–´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **ì½”ë“œ ì¬ì‚¬ìš©ì„±**
   - ì„ë² ë””ë“œ íƒ€ì…ì„ ì •ì˜í•˜ë©´ ì—¬ëŸ¬ ì—”í„°í‹°ì—ì„œ í•´ë‹¹ íƒ€ì…ì„ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
   - ì½”ë“œì˜ ì¤‘ë³µì„ ì¤„ì´ê³  ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

3. **ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— í¬í•¨**
   - ì„ë² ë””ë“œ íƒ€ì…ì€ í•´ë‹¹ ì—”í„°í‹°ì˜ í…Œì´ë¸”ì— ì»¬ëŸ¼ìœ¼ë¡œ í¬í•¨ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤. 
   - ë”°ë¡œ ë³„ë„ì˜ í…Œì´ë¸”ì„ ìƒì„±í•˜ì§€ ì•Šê³ , ì—”í„°í‹°ì˜ í…Œì´ë¸”ì— ê²°í•©ë©ë‹ˆë‹¤.

4. **ê°ì²´ì˜ ë¼ì´í”„ì‚¬ì´í´ì— ì¢…ì†ì **
   - ì„ë² ë””ë“œ íƒ€ì…ì€ í¬í•¨í•˜ëŠ” ì—”í„°í‹°ì˜ ë¼ì´í”„ì‚¬ì´í´ì— ì¢…ì†ì ì…ë‹ˆë‹¤. 
   - ì—”í„°í‹°ê°€ ì €ì¥, ìˆ˜ì •, ì‚­ì œë  ë•Œ ì„ë² ë””ë“œ íƒ€ì…ë„ ê°™ì´ ì²˜ë¦¬ë©ë‹ˆë‹¤.

5. **ê°’ íƒ€ì…ì˜ ë¶ˆë³€ì„± ìœ ì§€**
   - ì„ë² ë””ë“œ íƒ€ì…ì˜ ê°ì²´ëŠ” ë¶ˆë³€(immutable)í•´ì•¼ í•©ë‹ˆë‹¤. 
   - ì´ëŠ” ê°’ íƒ€ì…ì´ ì—”í„°í‹°ì˜ ë³€ê²½ ì¶”ì ì´ë‚˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

6. **@AttributeOverride**
   - ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë™ì¼í•œ íƒ€ì…ì´ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©ë  ë•Œ, 
     ê°ê°ì˜ ì‚¬ìš©ì— ëŒ€í•œ ë§¤í•‘ ì •ë³´ë¥¼ ì¬ì •ì˜í•˜ê¸° ìœ„í•´ `@AttributeOverride` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

7. **Null ê°€ëŠ¥ì„±**
   - ì„ë² ë””ë“œ íƒ€ì…ì€ ê°’ì´ ì—†ëŠ” ê²½ìš°(null)ê°€ëŠ¥í•˜ë©°, 
     ì—”í„°í‹°ì˜ ì†ì„±ìœ¼ë¡œ ì„ ì–¸ë˜ì—ˆì„ ë•Œ í•´ë‹¹ ì—”í„°í‹°ì˜ ê°’ì´ ì—†ëŠ” ê²½ìš°ì—ëŠ” í•´ë‹¹ ì„ë² ë””ë“œ íƒ€ì…ë„ nullì´ ë©ë‹ˆë‹¤.

8. **ê¸°ë³¸ ìƒì„±ì í•„ìš”**
   - ì„ë² ë””ë“œ íƒ€ì… í´ë˜ìŠ¤ì—ëŠ” JPAì—ì„œ ìš”êµ¬í•˜ëŠ” ê·œì¹™ì— ë”°ë¼ ê¸°ë³¸ ìƒì„±ìê°€ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.



### 3.2 ì„ë² ë””ë“œ íƒ€ì… ì˜ˆì œ 1

ì„ë² ë””ë“œ íƒ€ì…ì„ ì •ì˜í•˜ë ¤ë©´ `@Embeddable` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ì–´ë…¸í…Œì´ì…˜ì€ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì„ë² ë””ë“œ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.  **`@Embeddable` ì–´ë…¸í…Œì´ì…˜ì€ ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” í´ë˜ìŠ¤ì— í‘œì‹œ**í•˜ë©°, **`@Embedded` ì–´ë…¸í…Œì´ì…˜ì€ ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ì—”í„°í‹° í´ë˜ìŠ¤ì˜ ì†ì„±ì— í‘œì‹œ**í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì£¼ì†Œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” `Address` ì„ë² ë””ë“œ íƒ€ì…ì„ ì •ì˜í•´ë³´ê² ìŠµë‹ˆë‹¤.

```java
@Embeddable
public class Address {
    private String street;
    private String city;
    private String zipCode;

    // ìƒì„±ì, getter, setter ë“± í•„ìš”í•œ ë©”ì„œë“œë“¤ì„ êµ¬í˜„
}
```

ê·¸ë¦¬ê³  ì´ ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ì—”í„°í‹°ì¸ `Person` í´ë˜ìŠ¤ì—ì„œëŠ” `@Embedded` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì„ë² ë””ë“œ íƒ€ì…ì„ í•„ë“œë¡œ ì§€ì •í•©ë‹ˆë‹¤.

```java
@Entity
public class Person {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    @Embedded
    private Address address;

    // ìƒì„±ì, getter, setter ë“± í•„ìš”í•œ ë©”ì„œë“œë“¤ì„ êµ¬í˜„
}
```

`Person` ì—”í„°í‹° í´ë˜ìŠ¤ì—ì„œëŠ” `@Embedded` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ `Address`ë¥¼ ê°’ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” JPAì—ê²Œ í•´ë‹¹ í•„ë“œê°€ ê°’ íƒ€ì…ì„ì„ ì•Œë ¤ì¤ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ `Person` ì—”í„°í‹°ì˜ í…Œì´ë¸”ì—ëŠ” `Address`ì˜ í•„ë“œì¸ `street`, `city`, `zipCode`ê°€ ì»¬ëŸ¼ìœ¼ë¡œ ë§¤í•‘ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤.

ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆê°€ ë‹¨ìˆœí•´ì§€ê³ , ì½”ë“œì˜ ê°€ë…ì„±ì´ í–¥ìƒë˜ë©°, ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤. ë˜í•œ, ì„ë² ë””ë“œ íƒ€ì…ì„ ì¬ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì—”í„°í‹°ì—ì„œ ë™ì¼í•œ êµ¬ì¡°ì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



### 3.3 ì„ë² ë””ë“œ íƒ€ì… ì˜ˆì œ 2

```java
// ê¸°ê°„
private LocalDateTime startDate;
private LocalDateTime endDate;

// ì£¼ì†Œ
private String city;
private String street;
private String zipcode;

@Embedded
private Period workPeriod;

@Embedded
private Address HomeAddress;

@Embeddable
public class Period {

    private LocalDateTime startDate;
    private LocalDateTime endDate;

    // ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜
    // Getter, Setter ...
}
```

 

### ğŸŒ @AttributeOverride: ì†ì„± ì¬ì •ì˜

 ë§Œì•½ í•œ ì—”í‹°í‹°ì—ì„œ ê°™ì€ ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì»¬ëŸ¼ ëª… ì¤‘ë³µ ë¬¸ì œê°€ ìˆê¸° ë•Œë¬¸ì— `@AttributeOverrides`, `@AttributeOverride`ë¥¼ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ ëª… ì†ì„±ì„ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.

```java
// ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•˜ë©´ Repeated column in mapping for entity ì—ëŸ¬ ë°œìƒ
@Embedded
private Address HomeAddress;

@Embedded
private Address workAddress;
@Embedded
private Address HomeAddress;

@Embedded
@AttributeOverrides({
        @AttributeOverride(name = "city",
                column = @Column(name = "WORK_CITY")),
        @AttributeOverride(name = "street",
                column = @Column(name = "WORK_STREET")),
        @AttributeOverride(name = "zipcode",
                column = @Column(name = "WORK_ZIPCODE"))
})
private Address workAddress;
```

 

------

 

## ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´

 

### ğŸŒ ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°

 ì„ë² ë””ë“œ íƒ€ì… ê°™ì€ ê°’ íƒ€ì…ì„ ì—¬ëŸ¬ ì—”í‹°í‹°ì—ì„œ ê³µìœ í•˜ë©´ ë¶€ì‘ìš©(Side Effect)ê°€ ë°œìƒí•´ì„œ ìœ„í—˜í•˜ë‹¤. í•­ìƒ ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ë©´ ê³µìœ  ì°¸ì¡°ë¥¼ í”¼í•  ìˆ˜ ìˆì§€ë§Œ ë¬¸ì œëŠ” ì„ë² ë””ë“œ íƒ€ì…ì²˜ëŸ¼ ì§ì ‘ ì •ì˜í•œ ê°’ íƒ€ì…ì€ ê°ì²´ íƒ€ì…ì´ë¯€ë¡œ ì°¸ì¡° ê°’ì„ ì§ì ‘ ëŒ€ì…í•˜ëŠ” ê²ƒì„ ë§‰ì„ ë°©ë²•ì´ ì—†ë‹¤. ì¦‰, ê°ì²´ì˜ ê³µìœ  ì°¸ì¡°ëŠ” í”¼í•  ìˆ˜ ì—†ë‹¤. (íƒ€ì…ë§Œ ë§ìœ¼ë©´ ëŒ€ì…ì´ ê°€ëŠ¥í•˜ë‹¤.)

#### ê¸°ë³¸ íƒ€ì…

```java
int a = 10;
int b = a; // ê°’ ë³µì‚¬ => bì˜ ê°’ì„ ë³€ê²½í•˜ë©´ bë§Œ update
```

#### ê°ì²´ íƒ€ì…

```java
Address a = new Address("Old");
Address a = a;
b.setCity("New"); // aì™€ b ë‘˜ ë‹¤ update
```

 

### ğŸŒ ë¶ˆë³€ ê°ì²´

 ë¶ˆë³€ ê°ì²´ë€ ìƒì„± ì‹œì  ì´í›„ì— ì ˆëŒ€ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ê°ì²´ë¥¼ ë§í•œë‹¤. ê°’ íƒ€ì…ì„ ë¶ˆë³€ ê°ì²´ë¡œ ì„¤ê³„í•˜ë©´ ë¶€ì‘ìš©ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆë‹¤. ìƒì„±ìë¡œë§Œ ê°’ì„ ì„¤ì •í•˜ê³  ìˆ˜ì •ì(Setter)ë¥¼ ë§Œë“¤ì§€ ì•Šìœ¼ë©´ ëœë‹¤. (í˜¹ì€ privateë¡œ ë§Œë“ ë‹¤.) ê°’ì„ ë°”ê¾¸ê³  ì‹¶ìœ¼ë©´ ê°ì²´ ìì²´ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ êµì²´í•˜ëŠ” ë°©ë²• ë“±ì„ íƒí•  ìˆ˜ ìˆë‹¤.

 

------

 

## ê°’ íƒ€ì…ì˜ ë¹„êµ

 

 ê°’ íƒ€ì…ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹¬ë¼ë„ ê·¸ ì•ˆì— ê°’ì´ ê°™ìœ¼ë©´ ê°™ì€ ê²ƒìœ¼ë¡œ ë´ì•¼ í•œë‹¤. ê°’ íƒ€ì…ì€ `a.equals(b)`ë¥¼ ì‚¬ìš©í•´ì„œ ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼ í•œë‹¤. ê°’ íƒ€ì…ì˜ `equals()` ë©”ì†Œë“œë¥¼ ì ì ˆí•˜ê²Œ ì¬ì •ì˜í•œë‹¤.

- ë™ì¼ì„±(identity) ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡° ê°’ì„ ë¹„êµí•œë‹¤. `==`
- ë™ë“±ì„±(equivalence) ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ê°’ì„ ë¹„êµí•œë‹¤. `equals`

```typescript
@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    Address address = (Address) o;
    return Objects.equals(city, address.city) &&
            Objects.equals(street, address.street) &&
            Objects.equals(zipcode, address.zipcode);
}

@Override
public int hashCode() {
    return Objects.hash(city, street, zipcode);
}
```

 

------

 

## ê°’ íƒ€ì… ì»¬ë ‰ì…˜

 



![img](https://blog.kakaocdn.net/dn/bvV5W7/btrXIknYWhv/ixvtMOmLlHAoVuXmAVcDUK/img.png)



ë³„ë„ì˜ ì‹ë³„ì Id ê°’ì„ ë‘ë©´ ê°’ íƒ€ì…ì´ ì•„ë‹Œ ì—”í‹°í‹°ê°€ ë˜ì–´ë²„ë¦°ë‹¤



 ì‹¤ë¬´ì—ì„œëŠ” ìƒí™©ì— ë”°ë¼ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ê³ ë ¤í•œë‹¤. ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ìœ„í•œ ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê³ , ì—¬ê¸°ì— ê°’ íƒ€ì…ì„ ì‚¬ìš©í•œë‹¤. ì˜ì†ì„± ì „ì´ì™€ ê³ ì•„ ê°ì²´ ì œê±°ë¥¼ ì‚¬ìš©í•´ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì²˜ëŸ¼ ì‚¬ìš©í•œë‹¤. (ê°’ íƒ€ì…ì„ ì—”í‹°í‹°ë¡œ ìŠ¹ê¸‰í•œë‹¤.)

### ğŸŒ @ElementCollection, @CollctionTable

ë‹«ê¸°

 ê°’ íƒ€ì…ì„ í•˜ë‚˜ ì´ìƒ ì €ì¥í•  ë•Œ ì‚¬ìš©í•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì»¬ë ‰ì…˜ì„ ê°™ì€ í…Œì´ë¸”ì— ì €ì¥í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì»¬ë ‰ì…˜ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ë³„ë„ì˜ í…Œì´ë¸”ì´ í•„ìš”í•˜ë‹¤. ê°’ íƒ€ì… ì»¬ë ‰ì…˜ë„ ì§€ì—° ë¡œë”© ì „ëµì„ ì‚¬ìš©í•œë‹¤.

Memberì˜ username í•„ë“œì™€ ê°™ì´ ì·¨ê¸‰ë˜ê¸° ë•Œë¬¸ì— Member ì—”í‹°í‹°ì™€ ìƒëª…ì£¼ê¸°ë¥¼ í•¨ê»˜ í•œë‹¤. ì˜ì†ì„± ì „ì´(Cascade) + ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ì„ í•„ìˆ˜ë¡œ ê°€ì§„ë‹¤.

```java
@Embedded
private Address homeAddress;

@ElementCollection
@CollectionTable(name = "FAVORITE_FOOD", joinColumns =
    @JoinColumn(name = "MEMBER_ID")
)
@Column(name = "FOOD_NAME")
private Set<String> favoriteFoods = new HashSet<>();

@ElementCollection
@CollectionTable(name = "ADDRESS", joinColumns =
    @JoinColumn(name = "MEMBER_ID")
)
private List<Address> addressHistory = new ArrayList<>();
Member member = new Member();
member.setUsername("member1");
member.setHomeAddress(new Address("homeCity", "street", "10000"));

member.getFavoriteFoods().add("ì¹˜í‚¨");
member.getFavoriteFoods().add("ì¡±ë°œ");
member.getFavoriteFoods().add("í”¼ì");

member.getAddressHistory().add(new Address("old1", "street", "10000"));
member.getAddressHistory().add(new Address("old2", "street", "10000"));

em.persist(member);
```

![img](https://blog.kakaocdn.net/dn/njkOm/btrXM4RUfS4/mZSTZF7FvJFZ5blGRktKn1/img.png)

 

### ğŸŒ ì œì•½ì‚¬í•­

 ê°’ íƒ€ì…ì€ ì—”í‹°í‹°ì™€ ë‹¤ë¥´ê²Œ ì‹ë³„ì ê°œë…ì´ ì—†ë‹¤. ë˜í•œ ê°’ì€ ë³€ê²½í•˜ë©´ ì¶”ì ì´ ì–´ë µë‹¤. ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³€ê²½ì´ ë°œìƒí•˜ë©´, ì£¼ì¸ ì—”í‹°í‹°ì™€ ì—°ê´€ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³ , ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ìˆëŠ” í˜„ì¬ ê°’ì„ ëª¨ë‘ ë‹¤ì‹œ ì €ì¥í•œë‹¤.
(ê°’ì„ ìˆ˜ì • ë° ì‚­ì œí•  ë•Œ í˜„ì¬ MEMBER_IDì™€ ê´€ë ¨ëœ ë°ì´í„°ë¥¼ ì „ë¶€ ì§€ìš´ë‹¤.)

ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì„ ë§¤í•‘í•˜ëŠ” í…Œì´ë¸”ì€ ëª¨ë“  ì»¬ëŸ¼ì„ ë¬¶ì–´ì„œ ê¸°ë³¸ í‚¤ë¥¼ êµ¬ì„±í•´ì•¼ í•œë‹¤. (null ì…ë ¥ X, ì¤‘ë³µ ì €ì¥ X)

#### ê°’ íƒ€ì… ìˆ˜ì •

ê°’ì„ ì—…ë°ì´íŠ¸ í•  ë•Œ ì‚¬ì´ë“œ ì´í™íŠ¸ ë°œìƒì„ ì£¼ì˜í•´ì„œ setì„ í†µí•´ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ì‚­ì œ í›„ ì¶”ê°€í•œë‹¤.

```java
findMember.getFavoriteFoods().remove("ì¹˜í‚¨");
findMember.getFavoriteFoods().add("í•œì‹");
```

#### ê°’ íƒ€ì… ì‚­ì œ

```java
findMember.getAddressHistory().remove(new Address("old1", "street", "10000"));
findMember.getAddressHistory().add(new Address("newCity1", "street", "10000"));
```

delete ì¿¼ë¦¬ í•œ ë²ˆ, insert ì¿¼ë¦¬ í•œ ë²ˆì´ ë‚ ì•„ê°ˆ ê²ƒì´ë¼ê³  ì˜ˆìƒí–ˆìœ¼ë‚˜, insertê°€ ë‘ ë²ˆ(ord1, newCity1) ë°œìƒí•œë‹¤.

```sql
Hibernate: 
    /* delete collection hellojpa.Member.addressHistory */ delete 
        from
            ADDRESS 
        where
            MEMBER_ID=?
Hibernate: 
    /* insert collection
        row hellojpa.Member.addressHistory */ insert 
        into
            ADDRESS
            (MEMBER_ID, city, street, zipcode) 
        values
            (?, ?, ?, ?)
Hibernate: 
    /* insert collection
        row hellojpa.Member.addressHistory */ insert 
        into
            ADDRESS
            (MEMBER_ID, city, street, zipcode) 
        values
            (?, ?, ?, ?)
```